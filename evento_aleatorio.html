<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Crear evento aleatorio</title>
</head>
<body>
  <h1>üé≤ Crear Evento Aleatorio</h1>
  <button onclick="crearEventoAleatorio()">‚ûï Crear evento</button>
  <div id="resultado" style="margin-top:20px;">Esperando acci√≥n...</div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = "https://uenvbpfyjfdwbleenkyj.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVlbnZicGZ5amZkd2JsZWVua3lqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA2NTA5MjUsImV4cCI6MjA2NjIyNjkyNX0.23sLCLNvAeRj3apPvgps6nqrVk4Qf7qaBWGyyHqN_qM";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const gustosDisponibles = ["Naturaleza", "M√∫sica", "Lectura", "Mascotas", "Senderismo", "Cine", "Caf√©", "Deporte"];
    const lugares = ["Parque Principal", "Mirador", "Casa de la Cultura", "Sal√≥n Comunal", "R√≠o La Agudelo", "Caf√© El Refugio"];

    function obtenerAleatorios(array, cantidad = 2) {
      const copia = [...array];
      const resultado = [];
      for (let i = 0; i < cantidad && copia.length; i++) {
        const index = Math.floor(Math.random() * copia.length);
        resultado.push(copia.splice(index, 1)[0]);
      }
      return resultado;
    }

    function fechaFuturaAleatoria() {
      const hoy = new Date();
      const diasAdelante = Math.floor(Math.random() * 14) + 1;
      hoy.setDate(hoy.getDate() + diasAdelante);
      return hoy.toISOString();
    }

    async function crearEventoAleatorio() {
      const nombre = "Evento Aleatorio " + Math.floor(Math.random() * 1000);
      const gustos = obtenerAleatorios(gustosDisponibles, 2);
      const lugar = lugares[Math.floor(Math.random() * lugares.length)];
      const fecha = fechaFuturaAleatoria();

      const { error } = await supabase
        .from("eventos")
        .insert([{
          nombre,
          descripcion: "Este es un evento generado autom√°ticamente.",
          gustos_relacionados: gustos,
          lugar,
          fecha,
          usuarios_confirmados: []
        }]);

      if (error) {
        document.getElementById("resultado").innerText = "‚ùå Error al crear evento.";
        console.error(error);
      } else {
        document.getElementById("resultado").innerText = `‚úÖ Evento "${nombre}" creado con gustos: ${gustos.join(", ")}`;
      }
    }
  </script>
</body>
</html>
